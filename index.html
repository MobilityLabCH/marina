<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Marinaphoto ‚Äî Photography Brief</title>

<!-- jsPDF for PDF generation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;900&family=Inter:wght@300;400;500;600;700&display=swap');

:root {
  --cream: #F5F1E8;
  --gold: #C8A882;
  --dark: #2C2C2C;
  --white: #FEFEFE;
  --gold-light: #E5D5BC;
  --shadow-soft: 0 4px 24px rgba(44, 44, 44, 0.08);
  --shadow-hard: 0 8px 40px rgba(44, 44, 44, 0.12);
}

* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--cream);
  color: var(--dark);
  line-height: 1.6;
  overflow-x: hidden;
}

/* Typography */
h1, h2, h3 {
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  color: var(--dark);
  line-height: 1.2;
}

h1 { font-size: clamp(28px, 5vw, 42px); margin-bottom: 16px; }
h2 { font-size: clamp(22px, 4vw, 32px); margin-bottom: 14px; }
h3 { font-size: clamp(18px, 3vw, 24px); margin-bottom: 12px; }

/* Container */
.container {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 40px 20px;
  max-width: 100%;
}

/* Header */
.header {
  width: 100%;
  max-width: 900px;
  margin-bottom: 32px;
  animation: fadeInDown 0.6s ease;
}

.brand-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  flex-wrap: wrap;
  gap: 16px;
}

.brand {
  font-family: 'Playfair Display', serif;
  font-size: 24px;
  font-weight: 700;
  color: var(--dark);
  letter-spacing: 0.5px;
}

.brand small {
  font-size: 14px;
  color: var(--gold);
  font-weight: 400;
  margin-left: 8px;
}

.lang-switcher {
  display: flex;
  gap: 4px;
  background: var(--white);
  padding: 4px;
  border-radius: 20px;
  box-shadow: var(--shadow-soft);
}

.lang-switcher button {
  background: transparent;
  border: none;
  color: var(--dark);
  opacity: 0.5;
  padding: 8px 16px;
  border-radius: 16px;
  cursor: pointer;
  font-weight: 600;
  font-size: 13px;
  transition: all 0.3s ease;
  font-family: 'Inter', sans-serif;
}

.lang-switcher button:hover {
  opacity: 0.8;
}

.lang-switcher button.active {
  background: var(--gold);
  color: var(--white);
  opacity: 1;
}

/* Progress bar */
.progress-container {
  background: var(--white);
  border-radius: 20px;
  padding: 20px 24px;
  box-shadow: var(--shadow-soft);
  margin-bottom: 16px;
}

.progress-bar {
  height: 8px;
  background: var(--cream);
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 12px;
  position: relative;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--gold) 0%, var(--gold-light) 100%);
  border-radius: 10px;
  width: 0%;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.progress-fill::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.progress-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
  color: var(--dark);
  opacity: 0.7;
  font-weight: 500;
}

.time-remaining {
  color: var(--gold);
  font-weight: 600;
}

/* Card */
.card {
  width: 100%;
  max-width: 900px;
  background: var(--white);
  border-radius: 24px;
  padding: clamp(32px, 5vw, 48px);
  box-shadow: var(--shadow-hard);
  animation: fadeInUp 0.6s ease;
  min-height: 500px;
}

.kicker {
  font-size: 12px;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--gold);
  font-weight: 700;
  margin-bottom: 16px;
}

.lead {
  font-size: 18px;
  color: var(--dark);
  opacity: 0.8;
  margin-bottom: 24px;
  line-height: 1.6;
}

.hint {
  font-size: 14px;
  color: var(--dark);
  opacity: 0.6;
  margin-top: 16px;
  font-style: italic;
}

/* Inputs */
input[type="text"],
textarea {
  width: 100%;
  padding: 16px 20px;
  background: var(--cream);
  border: 2px solid transparent;
  border-radius: 16px;
  color: var(--dark);
  outline: none;
  margin-top: 16px;
  font-size: 16px;
  font-family: 'Inter', sans-serif;
  transition: all 0.3s ease;
}

input[type="text"]:focus,
textarea:focus {
  border-color: var(--gold);
  background: var(--white);
  box-shadow: 0 0 0 4px rgba(200, 168, 130, 0.1);
}

input[type="text"]::placeholder,
textarea::placeholder {
  color: var(--dark);
  opacity: 0.4;
}

textarea {
  min-height: 120px;
  resize: vertical;
}

/* Options */
.options {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin: 24px 0;
}

.option {
  padding: 20px 24px;
  background: var(--cream);
  border: 2px solid transparent;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.option::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.option:hover {
  background: var(--white);
  border-color: var(--gold-light);
  transform: translateY(-2px);
  box-shadow: var(--shadow-soft);
}

.option.selected {
  background: var(--white);
  border-color: var(--gold);
  box-shadow: 0 0 0 4px rgba(200, 168, 130, 0.1);
}

.option.selected::after {
  content: '‚úì';
  position: absolute;
  top: 16px;
  right: 20px;
  width: 28px;
  height: 28px;
  background: var(--gold);
  color: var(--white);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 14px;
}

.option-title {
  font-size: 17px;
  font-weight: 700;
  color: var(--dark);
  margin-bottom: 6px;
  position: relative;
  z-index: 1;
}

.option-desc {
  font-size: 14px;
  color: var(--dark);
  opacity: 0.7;
  line-height: 1.5;
  position: relative;
  z-index: 1;
}

/* Sliders */
.slider-container {
  margin: 24px 0;
  padding: 24px;
  background: var(--cream);
  border-radius: 20px;
  border: 2px solid transparent;
  transition: all 0.3s ease;
}

.slider-container:hover {
  border-color: var(--gold-light);
  background: var(--white);
}

.slider-label {
  display: flex;
  justify-content: space-between;
  margin-bottom: 16px;
  font-size: 15px;
  font-weight: 600;
  color: var(--dark);
}

input[type="range"] {
  width: 100%;
  height: 8px;
  -webkit-appearance: none;
  appearance: none;
  background: rgba(200, 168, 130, 0.2);
  border-radius: 10px;
  outline: none;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 24px;
  height: 24px;
  background: var(--gold);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(200, 168, 130, 0.4);
  transition: all 0.2s ease;
}

input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.1);
  box-shadow: 0 4px 12px rgba(200, 168, 130, 0.6);
}

input[type="range"]::-moz-range-thumb {
  width: 24px;
  height: 24px;
  background: var(--gold);
  border-radius: 50%;
  cursor: pointer;
  border: none;
  box-shadow: 0 2px 8px rgba(200, 168, 130, 0.4);
  transition: all 0.2s ease;
}

input[type="range"]::-moz-range-thumb:hover {
  transform: scale(1.1);
  box-shadow: 0 4px 12px rgba(200, 168, 130, 0.6);
}

.slider-hints {
  display: flex;
  justify-content: space-between;
  margin-top: 12px;
  font-size: 13px;
  color: var(--dark);
  opacity: 0.6;
  font-style: italic;
}

/* Buttons */
.buttons {
  display: flex;
  gap: 12px;
  margin-top: 32px;
  flex-wrap: wrap;
}

button {
  padding: 16px 32px;
  border-radius: 50px;
  border: 2px solid var(--gold);
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
  font-family: 'Inter', sans-serif;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

button::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  transform: translate(-50%, -50%);
  transition: width 0.6s ease, height 0.6s ease;
}

button:hover::before {
  width: 300px;
  height: 300px;
}

button.primary {
  background: var(--gold);
  color: var(--white);
  border-color: var(--gold);
}

button.primary:hover {
  background: #B89970;
  border-color: #B89970;
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(200, 168, 130, 0.3);
}

button.secondary {
  background: transparent;
  color: var(--gold);
  border-color: var(--gold);
}

button.secondary:hover {
  background: var(--gold);
  color: var(--white);
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(200, 168, 130, 0.3);
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none !important;
}

/* Loading spinner */
.loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
}

.spinner {
  width: 60px;
  height: 60px;
  border: 4px solid var(--cream);
  border-top-color: var(--gold);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 24px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading h2 {
  margin-bottom: 12px;
}

.loading p {
  color: var(--dark);
  opacity: 0.6;
}

/* Report sections */
.report-section {
  margin: 32px 0;
  padding: 28px;
  background: var(--cream);
  border-radius: 20px;
  border-left: 4px solid var(--gold);
}

.report-section h3 {
  margin-bottom: 16px;
  color: var(--dark);
}

.report-section p {
  margin-bottom: 12px;
  line-height: 1.7;
  color: var(--dark);
  opacity: 0.85;
}

.report-section strong {
  color: var(--dark);
  font-weight: 700;
}

.report-closing {
  background: linear-gradient(135deg, var(--gold-light) 0%, var(--gold) 100%);
  border-left: none;
  color: var(--white);
}

.report-closing h3,
.report-closing p {
  color: var(--white);
  opacity: 1;
}

/* Radar chart */
.radar-container {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 32px;
  background: var(--white);
  border-radius: 20px;
  margin: 24px 0;
}

#radarChart {
  max-width: 100%;
  height: auto;
}

/* Tags */
.tags {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin: 20px 0;
}

.tag {
  padding: 8px 16px;
  background: var(--gold-light);
  color: var(--dark);
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 0.5px;
}

/* Animations */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeInDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fade-in {
  animation: fadeInUp 0.6s ease;
}

/* Responsive */
@media (max-width: 768px) {
  .container {
    padding: 20px 16px;
  }
  
  .card {
    padding: 24px 20px;
  }
  
  .buttons {
    flex-direction: column;
  }
  
  button {
    width: 100%;
  }
  
  .brand-header {
    flex-direction: column;
    align-items: flex-start;
  }
}

/* Print styles */
@media print {
  body {
    background: white;
  }
  
  .header,
  .buttons,
  button {
    display: none !important;
  }
  
  .card {
    box-shadow: none;
    page-break-inside: avoid;
  }
}
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <div class="brand-header">
      <div class="brand">
        MARINAPHOTO
        <small>Photography Brief</small>
      </div>
      <div class="lang-switcher">
        <button onclick="setLang('en')" id="btn-en">EN</button>
        <button onclick="setLang('fr')" id="btn-fr" class="active">FR</button>
        <button onclick="setLang('es')" id="btn-es">ES</button>
      </div>
    </div>
    
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" id="progress"></div>
      </div>
      <div class="progress-info">
        <span id="step-label">‚Äî</span>
        <span class="time-remaining" id="time-remaining">~3 min</span>
      </div>
    </div>
  </div>

  <div class="card fade-in" id="content">
    <!-- Content will be inserted here -->
  </div>
</div>

<script>
// Global state
let currentStep = 0;
let currentLang = 'fr';
let state = {
  name: '',
  project: '',
  core: null,
  intent: [],
  time: null,
  where: [],
  location: null,
  timing: null,
  sliders: { calm: 50, present: 50, rich: 50 }
};

// Translations
const translations = {
  fr: {
    toolName: 'MARINAPHOTO',
    toolTagline: 'Photography Brief',
    steps: ['Intro', 'Vous', 'Projet', 'Essence', 'Intention', 'Usage', 'Canaux', 'Lieu', 'Timing', 'Ambiance', 'Rapport'],
    timeEstimates: ['3 min', '3 min', '2 min', '2 min', '2 min', '1 min', '1 min', '1 min', '30 sec', '30 sec', 'Termin√©'],
    intro: {
      kicker: 'Commen√ßons par l\'essentiel',
      title: '3 minutes. Z√©ro jargon. Un rapport clair.',
      text: 'Chaque projet commence par comprendre ce qui compte vraiment. R√©pondez par instinct ‚Äî je transforme vos r√©ponses en un brief clair qui guide notre collaboration, avec mon regard, sans artifice.',
      button: 'Commencer'
    },
    name: {
      kicker: 'Vous & le projet',
      title: 'Quel est votre pr√©nom ?',
      text: 'Pr√©nom ou pseudo ‚Äî comme vous pr√©f√©rez.',
      placeholder: 'Ex : Alex',
      button: 'Continuer'
    },
    project: {
      kicker: 'Vous & le projet',
      title: 'Nom du projet',
      text: 'M√™me provisoire. √áa m\'aide √† personnaliser le rapport.',
      placeholder: 'Ex : H√¥tel Casa Marina / Restaurant Can Pau...',
      button: 'Continuer'
    },
    core: {
      kicker: 'Essence',
      title: 'En une phrase, votre projet, c\'est plut√¥t‚Ä¶',
      text: 'Choisissez l\'option la plus √©vidente.',
      options: [
        { id: 'place', title: 'üè† Un lieu', desc: 'Faire ressentir : lumi√®re, mati√®re, atmosph√®re.' },
        { id: 'story', title: 'üìñ Une histoire', desc: 'Des gens, des gestes, une narration.' },
        { id: 'moment', title: '‚è≥ Un moment', desc: 'Aller √† l\'essentiel, sans surjouer.' }
      ],
      button: 'Continuer'
    },
    intent: {
      kicker: 'Essence',
      title: 'Quand quelqu\'un voit ces images, vous voulez qu\'il se dise‚Ä¶',
      text: 'Choisissez 1 ou 2.',
      options: [
        { id: 'notAI', title: '¬´ Ce ne sont pas des images IA. ¬ª', desc: 'On sent du vrai : pr√©sence, mati√®re, lumi√®re.' },
        { id: 'brand', title: '¬´ √áa refl√®te parfaitement ma marque. ¬ª', desc: 'Coh√©rent, reconnaissable, align√©.' },
        { id: 'fresh', title: '¬´ C\'est un regard artistique, neuf. ¬ª', desc: 'Pas du d√©j√†-vu. Une vraie signature.' },
        { id: 'trust', title: '¬´ √áa me donne confiance. ¬ª', desc: 'Cr√©dible, humain, juste.' }
      ],
      button: 'Continuer',
      hint: 'Max 2 choix'
    },
    time: {
      kicker: 'Usage',
      title: 'Ces images doivent surtout servir‚Ä¶',
      text: '√áa aide √† doser le rythme et la quantit√©.',
      options: [
        { id: 'moment', title: 'üìÜ Un moment pr√©cis', desc: 'Lancement, campagne, √©v√©nement.' },
        { id: 'overtime', title: 'üîÅ Une base r√©utilisable', desc: 'Des visuels qui durent et se d√©clinent.' },
        { id: 'grow', title: 'üå± Une continuit√©', desc: 'S√©rie + suivi : √ßa √©volue dans le temps.' }
      ],
      button: 'Continuer'
    },
    where: {
      kicker: 'Usage',
      title: 'O√π ces images vont vivre le plus souvent ?',
      text: 'Max 2. L√† o√π vous allez vraiment les utiliser.',
      options: [
        { id: 'website', title: 'Site web', desc: 'Lecture pos√©e, cr√©dibilit√©.' },
        { id: 'social', title: 'R√©seaux sociaux', desc: 'Rythme, r√©p√©tition, s√©rie.' },
        { id: 'editorial', title: 'Presse / editorial', desc: 'Contexte, narration, d√©tails.' },
        { id: 'print', title: 'Print', desc: 'Impact, mati√®re, permanence.' }
      ],
      button: 'Continuer',
      hint: 'Max 2 choix'
    },
    location: {
      kicker: 'Logistique',
      title: 'O√π se d√©roulera la s√©ance ?',
      text: 'Le lieu impacte ma pr√©paration et mon approche.',
      options: [
        { id: 'sitges', title: 'üìç Sitges et environs', desc: 'Garraf, Vilanova, Cubelles...' },
        { id: 'barcelona', title: 'üìç Barcelone', desc: 'Centre ou p√©riph√©rie.' },
        { id: 'catalonia', title: 'üìç Ailleurs en Catalogne', desc: 'Costa Brava, Tarragone...' },
        { id: 'other', title: 'üìç En dehors de Catalogne', desc: '√Ä pr√©ciser ensemble.' }
      ],
      button: 'Continuer'
    },
    timing: {
      kicker: 'Logistique',
      title: 'Quand avez-vous besoin des images ?',
      text: '√áa m\'aide √† organiser mon planning.',
      options: [
        { id: 'fixed', title: 'üìÖ Date fix√©e', desc: 'J\'ai une deadline pr√©cise.' },
        { id: 'approx', title: 'üìÜ P√©riode approximative', desc: 'Dans les prochaines semaines/mois.' },
        { id: 'flexible', title: 'üåä Flexible', desc: 'Pas d\'urgence particuli√®re.' }
      ],
      button: 'Continuer'
    },
    vibe: {
      kicker: 'Ambiance',
      title: 'Comment je dois photographier ?',
      text: 'Ajustez les curseurs selon l\'ambiance souhait√©e. Cela guide mon approche sans changer ma signature visuelle.',
      sliders: [
        { 
          id: 'calm', 
          left: 'üòå Calme', 
          right: '‚ö° Vivant',
          leftDesc: 'Images pos√©es, contemplatives',
          rightDesc: '√ânergie, mouvement, dynamisme'
        },
        { 
          id: 'present', 
          left: 'üëÄ Discret', 
          right: 'ü§ç Proche',
          leftDesc: 'Observer de loin, contexte large',
          rightDesc: 'Intimit√©, d√©tails, proximit√©'
        },
        { 
          id: 'rich', 
          left: '‚úÇÔ∏è √âpur√©', 
          right: 'üß± Textur√©',
          leftDesc: 'Minimalisme, simplicit√©',
          rightDesc: 'Mati√®res, textures, richesse'
        }
      ],
      button: 'Voir le rapport'
    },
    report: {
      kicker: 'Votre brief',
      title: 'G√©n√©ration en cours...',
      loading: 'Je cr√©e votre brief personnalis√©',
      loadingDesc: 'Analyse de vos r√©ponses et synth√®se de votre projet...',
      buttons: {
        restart: 'Recommencer',
        email: 'Envoyer √† Marina',
        pdf: 'T√©l√©charger PDF'
      }
    },
    back: 'Retour',
    pickOne: 'Choisissez une option üôÇ',
    pickAtLeastOne: 'Choisissez au moins une option üôÇ'
  },
  en: {
    toolName: 'MARINAPHOTO',
    toolTagline: 'Photography Brief',
    steps: ['Intro', 'You', 'Project', 'Essence', 'Intent', 'Use', 'Channels', 'Location', 'Timing', 'Vibe', 'Report'],
    timeEstimates: ['3 min', '3 min', '2 min', '2 min', '2 min', '1 min', '1 min', '1 min', '30 sec', '30 sec', 'Done'],
    intro: {
      kicker: 'Let\'s start with what matters',
      title: '3 minutes. No jargon. A clear report.',
      text: 'Every project starts with understanding what really matters. Answer by instinct ‚Äî I turn it into a clear brief that guides our work together, with my eye, no artifice.',
      button: 'Start'
    },
    name: {
      kicker: 'You & project',
      title: 'What\'s your first name?',
      text: 'First name or nickname ‚Äî your choice.',
      placeholder: 'e.g. Alex',
      button: 'Continue'
    },
    project: {
      kicker: 'You & project',
      title: 'Project name',
      text: 'Even temporary. Helps personalize the report.',
      placeholder: 'e.g. Casa Marina Hotel / Can Pau Restaurant...',
      button: 'Continue'
    },
    core: {
      kicker: 'Essence',
      title: 'In one sentence, your project is mostly‚Ä¶',
      text: 'Pick the most obvious option.',
      options: [
        { id: 'place', title: 'üè† A place', desc: 'Make people feel it: light, texture, atmosphere.' },
        { id: 'story', title: 'üìñ A story', desc: 'People, gestures, a narrative thread.' },
        { id: 'moment', title: '‚è≥ A moment', desc: 'Keep what matters, no overacting.' }
      ],
      button: 'Continue'
    },
    intent: {
      kicker: 'Essence',
      title: 'When people see these images, you want them to think‚Ä¶',
      text: 'Pick 1 or 2.',
      options: [
        { id: 'notAI', title: '"These are not AI images."', desc: 'It feels real: presence, texture, light.' },
        { id: 'brand', title: '"This perfectly matches my brand."', desc: 'Consistent, recognizable, aligned.' },
        { id: 'fresh', title: '"It\'s a fresh artistic eye."', desc: 'Not generic. A real signature.' },
        { id: 'trust', title: '"This makes me trust you."', desc: 'Credible, human, true.' }
      ],
      button: 'Continue',
      hint: 'Max 2'
    },
    time: {
      kicker: 'Use',
      title: 'These images should mainly serve‚Ä¶',
      text: 'Helps set tempo and scope.',
      options: [
        { id: 'moment', title: 'üìÜ A specific moment', desc: 'Launch, campaign, event.' },
        { id: 'overtime', title: 'üîÅ A reusable base', desc: 'Visuals that last and can be reused.' },
        { id: 'grow', title: 'üå± Continuity', desc: 'Series + follow-up over time.' }
      ],
      button: 'Continue'
    },
    where: {
      kicker: 'Use',
      title: 'Where will these images live most often?',
      text: 'Max 2. Where you\'ll really use them.',
      options: [
        { id: 'website', title: 'Website', desc: 'Calm reading, credibility.' },
        { id: 'social', title: 'Social media', desc: 'Rhythm, repetition, series.' },
        { id: 'editorial', title: 'Editorial / press', desc: 'Context, narrative, detail.' },
        { id: 'print', title: 'Print', desc: 'Impact, materiality, permanence.' }
      ],
      button: 'Continue',
      hint: 'Max 2'
    },
    location: {
      kicker: 'Logistics',
      title: 'Where will the shoot take place?',
      text: 'Location impacts my preparation and approach.',
      options: [
        { id: 'sitges', title: 'üìç Sitges area', desc: 'Garraf, Vilanova, Cubelles...' },
        { id: 'barcelona', title: 'üìç Barcelona', desc: 'City center or suburbs.' },
        { id: 'catalonia', title: 'üìç Elsewhere in Catalonia', desc: 'Costa Brava, Tarragona...' },
        { id: 'other', title: 'üìç Outside Catalonia', desc: 'To be discussed together.' }
      ],
      button: 'Continue'
    },
    timing: {
      kicker: 'Logistics',
      title: 'When do you need the images?',
      text: 'This helps me organize my schedule.',
      options: [
        { id: 'fixed', title: 'üìÖ Fixed date', desc: 'I have a specific deadline.' },
        { id: 'approx', title: 'üìÜ Approximate period', desc: 'Within the next weeks/months.' },
        { id: 'flexible', title: 'üåä Flexible', desc: 'No particular urgency.' }
      ],
      button: 'Continue'
    },
    vibe: {
      kicker: 'Vibe',
      title: 'How should I photograph?',
      text: 'Adjust the sliders to match your desired vibe. This guides my approach without changing my visual signature.',
      sliders: [
        { 
          id: 'calm', 
          left: 'üòå Calm', 
          right: '‚ö° Lively',
          leftDesc: 'Still, contemplative images',
          rightDesc: 'Energy, movement, dynamism'
        },
        { 
          id: 'present', 
          left: 'üëÄ Discreet', 
          right: 'ü§ç Close',
          leftDesc: 'Observe from distance, wide context',
          rightDesc: 'Intimacy, details, closeness'
        },
        { 
          id: 'rich', 
          left: '‚úÇÔ∏è Minimal', 
          right: 'üß± Textured',
          leftDesc: 'Minimalism, simplicity',
          rightDesc: 'Materials, textures, richness'
        }
      ],
      button: 'See report'
    },
    report: {
      kicker: 'Your brief',
      title: 'Generating...',
      loading: 'Creating your personalized brief',
      loadingDesc: 'Analyzing your answers and synthesizing your project...',
      buttons: {
        restart: 'Restart',
        email: 'Send to Marina',
        pdf: 'Download PDF'
      }
    },
    back: 'Back',
    pickOne: 'Pick one üôÇ',
    pickAtLeastOne: 'Pick at least one üôÇ'
  },
  es: {
    toolName: 'MARINAPHOTO',
    toolTagline: 'Photography Brief',
    steps: ['Intro', 'Usted', 'Proyecto', 'Esencia', 'Intenci√≥n', 'Uso', 'Canales', 'Lugar', 'Timing', 'Vibra', 'Informe'],
    timeEstimates: ['3 min', '3 min', '2 min', '2 min', '2 min', '1 min', '1 min', '1 min', '30 seg', '30 seg', 'Listo'],
    intro: {
      kicker: 'Empecemos por lo esencial',
      title: '3 minutos. Sin jerga. Un informe claro.',
      text: 'Cada proyecto comienza por comprender lo que realmente importa. Responda por instinto ‚Äî transformo sus respuestas en un brief claro que gu√≠a nuestra colaboraci√≥n, con mi mirada, sin artificio.',
      button: 'Empezar'
    },
    name: {
      kicker: 'Usted & proyecto',
      title: '¬øCu√°l es su nombre?',
      text: 'Nombre o apodo ‚Äî como prefiera.',
      placeholder: 'p.ej. Alex',
      button: 'Continuar'
    },
    project: {
      kicker: 'Usted & proyecto',
      title: 'Nombre del proyecto',
      text: 'Aunque sea provisional. Me ayuda a personalizar el informe.',
      placeholder: 'p.ej. Hotel Casa Marina / Restaurante Can Pau...',
      button: 'Continuar'
    },
    core: {
      kicker: 'Esencia',
      title: 'En una frase, su proyecto es sobre todo‚Ä¶',
      text: 'Elija la opci√≥n m√°s evidente.',
      options: [
        { id: 'place', title: 'üè† Un lugar', desc: 'Sentir: luz, textura, atm√≥sfera.' },
        { id: 'story', title: 'üìñ Una historia', desc: 'Personas, gestos, un hilo narrativo.' },
        { id: 'moment', title: '‚è≥ Un momento', desc: 'Lo esencial, sin exagerar.' }
      ],
      button: 'Continuar'
    },
    intent: {
      kicker: 'Esencia',
      title: 'Cuando alguien vea estas im√°genes, usted quiere que piense‚Ä¶',
      text: 'Elija 1 o 2.',
      options: [
        { id: 'notAI', title: '¬´ No son im√°genes IA. ¬ª', desc: 'Se siente lo real: presencia, materia, luz.' },
        { id: 'brand', title: '¬´ Refleja perfectamente mi marca. ¬ª', desc: 'Coherente, reconocible, alineado.' },
        { id: 'fresh', title: '¬´ Es una mirada art√≠stica, nueva. ¬ª', desc: 'No gen√©rico. Una firma real.' },
        { id: 'trust', title: '¬´ Me da confianza. ¬ª', desc: 'Cre√≠ble, humano, verdadero.' }
      ],
      button: 'Continuar',
      hint: 'M√°x 2'
    },
    time: {
      kicker: 'Uso',
      title: 'Estas im√°genes deben servir sobre todo para‚Ä¶',
      text: 'Ayuda a definir ritmo y alcance.',
      options: [
        { id: 'moment', title: 'üìÜ Un momento concreto', desc: 'Lanzamiento, campa√±a, evento.' },
        { id: 'overtime', title: 'üîÅ Una base reutilizable', desc: 'Visuales que duran y se reutilizan.' },
        { id: 'grow', title: 'üå± Continuidad', desc: 'Serie + seguimiento con el tiempo.' }
      ],
      button: 'Continuar'
    },
    where: {
      kicker: 'Uso',
      title: '¬øD√≥nde vivir√°n estas im√°genes la mayor parte del tiempo?',
      text: 'M√°x 2. Donde realmente las usar√°.',
      options: [
        { id: 'website', title: 'Web', desc: 'Lectura calmada, credibilidad.' },
        { id: 'social', title: 'Redes sociales', desc: 'Ritmo, repetici√≥n, serie.' },
        { id: 'editorial', title: 'Editorial / prensa', desc: 'Contexto, relato, detalle.' },
        { id: 'print', title: 'Impresi√≥n', desc: 'Impacto, materia, permanencia.' }
      ],
      button: 'Continuar',
      hint: 'M√°x 2'
    },
    location: {
      kicker: 'Log√≠stica',
      title: '¬øD√≥nde se realizar√° la sesi√≥n?',
      text: 'El lugar impacta mi preparaci√≥n y enfoque.',
      options: [
        { id: 'sitges', title: 'üìç Sitges y alrededores', desc: 'Garraf, Vilanova, Cubelles...' },
        { id: 'barcelona', title: 'üìç Barcelona', desc: 'Centro o periferia.' },
        { id: 'catalonia', title: 'üìç Otra parte de Catalu√±a', desc: 'Costa Brava, Tarragona...' },
        { id: 'other', title: 'üìç Fuera de Catalu√±a', desc: 'A discutir juntos.' }
      ],
      button: 'Continuar'
    },
    timing: {
      kicker: 'Log√≠stica',
      title: '¬øCu√°ndo necesita las im√°genes?',
      text: 'Esto me ayuda a organizar mi agenda.',
      options: [
        { id: 'fixed', title: 'üìÖ Fecha fija', desc: 'Tengo una fecha l√≠mite espec√≠fica.' },
        { id: 'approx', title: 'üìÜ Per√≠odo aproximado', desc: 'En las pr√≥ximas semanas/meses.' },
        { id: 'flexible', title: 'üåä Flexible', desc: 'Sin urgencia particular.' }
      ],
      button: 'Continuar'
    },
    vibe: {
      kicker: 'Vibra',
      title: '¬øC√≥mo debo fotografiar?',
      text: 'Ajuste los cursores seg√∫n la vibra deseada. Esto gu√≠a mi enfoque sin cambiar mi firma visual.',
      sliders: [
        { 
          id: 'calm', 
          left: 'üòå Calmo', 
          right: '‚ö° Vivo',
          leftDesc: 'Im√°genes serenas, contemplativas',
          rightDesc: 'Energ√≠a, movimiento, dinamismo'
        },
        { 
          id: 'present', 
          left: 'üëÄ Discreto', 
          right: 'ü§ç Cercano',
          leftDesc: 'Observar desde lejos, contexto amplio',
          rightDesc: 'Intimidad, detalles, cercan√≠a'
        },
        { 
          id: 'rich', 
          left: '‚úÇÔ∏è Limpio', 
          right: 'üß± Texturado',
          leftDesc: 'Minimalismo, simplicidad',
          rightDesc: 'Materiales, texturas, riqueza'
        }
      ],
      button: 'Ver informe'
    },
    report: {
      kicker: 'Su brief',
      title: 'Generando...',
      loading: 'Creando su brief personalizado',
      loadingDesc: 'Analizando sus respuestas y sintetizando su proyecto...',
      buttons: {
        restart: 'Reiniciar',
        email: 'Enviar a Marina',
        pdf: 'Descargar PDF'
      }
    },
    back: 'Atr√°s',
    pickOne: 'Elija una üôÇ',
    pickAtLeastOne: 'Elija al menos una üôÇ'
  }
};

function t(key) {
  const keys = key.split('.');
  let result = translations[currentLang];
  for (let k of keys) {
    result = result[k];
    if (!result) return key;
  }
  return result;
}

function setLang(lang) {
  currentLang = lang;
  document.getElementById('btn-en').classList.remove('active');
  document.getElementById('btn-fr').classList.remove('active');
  document.getElementById('btn-es').classList.remove('active');
  document.getElementById('btn-' + lang).classList.add('active');
  render();
}

function updateProgress() {
  const progress = ((currentStep + 1) / 11) * 100;
  document.getElementById('progress').style.width = progress + '%';
  document.getElementById('step-label').textContent = 
    (currentStep + 1) + '/11 ¬∑ ' + t('steps')[currentStep];
  document.getElementById('time-remaining').textContent = 
    '~' + t('timeEstimates')[currentStep];
}

function nextStep() {
  if (currentStep < 10) {
    currentStep++;
    render();
  }
}

function prevStep() {
  if (currentStep > 0) {
    currentStep--;
    render();
  }
}

function render() {
  updateProgress();
  const content = document.getElementById('content');
  content.classList.remove('fade-in');
  
  setTimeout(() => {
    renderStep();
    content.classList.add('fade-in');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }, 50);
}

function renderStep() {
  const content = document.getElementById('content');
  let html = '';
  
  switch(currentStep) {
    case 0: html = renderIntro(); break;
    case 1: html = renderName(); break;
    case 2: html = renderProject(); break;
    case 3: html = renderCore(); break;
    case 4: html = renderIntent(); break;
    case 5: html = renderTime(); break;
    case 6: html = renderWhere(); break;
    case 7: html = renderLocation(); break;
    case 8: html = renderTiming(); break;
    case 9: html = renderVibe(); break;
    case 10: renderReport(); return;
  }
  
  content.innerHTML = html;
  bindEvents();
}

function renderIntro() {
  return `
    <div class="kicker">${t('intro.kicker')}</div>
    <h1>${t('intro.title')}</h1>
    <p class="lead">${t('intro.text')}</p>
    <div class="buttons">
      <button class="primary" onclick="nextStep()">${t('intro.button')}</button>
    </div>
  `;
}

function renderName() {
  return `
    <div class="kicker">${t('name.kicker')}</div>
    <h1>${t('name.title')}</h1>
    <p class="lead">${t('name.text')}</p>
    <input type="text" id="name-input" value="${state.name}" placeholder="${t('name.placeholder')}">
    <div class="buttons">
      <button class="primary" onclick="saveName()">${t('name.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

function renderProject() {
  return `
    <div class="kicker">${t('project.kicker')}</div>
    <h1>${t('project.title')}</h1>
    <p class="lead">${t('project.text')}</p>
    <input type="text" id="project-input" value="${state.project}" placeholder="${t('project.placeholder')}">
    <div class="buttons">
      <button class="primary" onclick="saveProject()">${t('project.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

function renderCore() {
  const options = t('core.options');
  return `
    <div class="kicker">${t('core.kicker')}</div>
    <h1>${t('core.title')}</h1>
    <p class="lead">${t('core.text')}</p>
    <div class="options">
      ${options.map(opt => `
        <div class="option ${state.core === opt.id ? 'selected' : ''}" data-id="${opt.id}">
          <div class="option-title">${opt.title}</div>
          <div class="option-desc">${opt.desc}</div>
        </div>
      `).join('')}
    </div>
    <div class="buttons">
      <button class="primary" onclick="validateCore()">${t('core.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

function renderIntent() {
  const options = t('intent.options');
  return `
    <div class="kicker">${t('intent.kicker')}</div>
    <h1>${t('intent.title')}</h1>
    <p class="lead">${t('intent.text')}</p>
    <div class="options">
      ${options.map(opt => `
        <div class="option ${state.intent.includes(opt.id) ? 'selected' : ''}" data-id="${opt.id}">
          <div class="option-title">${opt.title}</div>
          <div class="option-desc">${opt.desc}</div>
        </div>
      `).join('')}
    </div>
    <p class="hint">${t('intent.hint')}</p>
    <div class="buttons">
      <button class="primary" onclick="validateIntent()">${t('intent.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

function renderTime() {
  const options = t('time.options');
  return `
    <div class="kicker">${t('time.kicker')}</div>
    <h1>${t('time.title')}</h1>
    <p class="lead">${t('time.text')}</p>
    <div class="options">
      ${options.map(opt => `
        <div class="option ${state.time === opt.id ? 'selected' : ''}" data-id="${opt.id}">
          <div class="option-title">${opt.title}</div>
          <div class="option-desc">${opt.desc}</div>
        </div>
      `).join('')}
    </div>
    <div class="buttons">
      <button class="primary" onclick="validateTime()">${t('time.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

function renderWhere() {
  const options = t('where.options');
  return `
    <div class="kicker">${t('where.kicker')}</div>
    <h1>${t('where.title')}</h1>
    <p class="lead">${t('where.text')}</p>
    <div class="options">
      ${options.map(opt => `
        <div class="option ${state.where.includes(opt.id) ? 'selected' : ''}" data-id="${opt.id}">
          <div class="option-title">${opt.title}</div>
          <div class="option-desc">${opt.desc}</div>
        </div>
      `).join('')}
    </div>
    <p class="hint">${t('where.hint')}</p>
    <div class="buttons">
      <button class="primary" onclick="validateWhere()">${t('where.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

function renderLocation() {
  const options = t('location.options');
  return `
    <div class="kicker">${t('location.kicker')}</div>
    <h1>${t('location.title')}</h1>
    <p class="lead">${t('location.text')}</p>
    <div class="options">
      ${options.map(opt => `
        <div class="option ${state.location === opt.id ? 'selected' : ''}" data-id="${opt.id}">
          <div class="option-title">${opt.title}</div>
          <div class="option-desc">${opt.desc}</div>
        </div>
      `).join('')}
    </div>
    <div class="buttons">
      <button class="primary" onclick="validateLocation()">${t('location.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

function renderTiming() {
  const options = t('timing.options');
  return `
    <div class="kicker">${t('timing.kicker')}</div>
    <h1>${t('timing.title')}</h1>
    <p class="lead">${t('timing.text')}</p>
    <div class="options">
      ${options.map(opt => `
        <div class="option ${state.timing === opt.id ? 'selected' : ''}" data-id="${opt.id}">
          <div class="option-title">${opt.title}</div>
          <div class="option-desc">${opt.desc}</div>
        </div>
      `).join('')}
    </div>
    <div class="buttons">
      <button class="primary" onclick="validateTiming()">${t('timing.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

function renderVibe() {
  const sliders = t('vibe.sliders');
  return `
    <div class="kicker">${t('vibe.kicker')}</div>
    <h1>${t('vibe.title')}</h1>
    <p class="lead">${t('vibe.text')}</p>
    ${sliders.map(slider => `
      <div class="slider-container">
        <div class="slider-label">
          <span>${slider.left}</span>
          <span>${slider.right}</span>
        </div>
        <input type="range" min="0" max="100" value="${state.sliders[slider.id]}" 
          data-key="${slider.id}" oninput="updateSlider(this)">
        <div class="slider-hints">
          <span>${slider.leftDesc}</span>
          <span>${slider.rightDesc}</span>
        </div>
      </div>
    `).join('')}
    <div class="buttons">
      <button class="primary" onclick="nextStep()">${t('vibe.button')}</button>
      <button class="secondary" onclick="prevStep()">${t('back')}</button>
    </div>
  `;
}

async function renderReport() {
  const content = document.getElementById('content');
  
  // Show loading
  content.innerHTML = `
    <div class="loading">
      <div class="spinner"></div>
      <h2>${t('report.loading')}</h2>
      <p>${t('report.loadingDesc')}</p>
    </div>
  `;
  
  // Generate AI brief
  try {
    const aiReport = await generateAIBrief();
    displayReport(aiReport);
  } catch (error) {
    console.error('AI generation failed, using fallback:', error);
    const fallbackReport = generateFallbackReport();
    displayReport(fallbackReport);
  }
}

async function generateAIBrief() {
  const coreMap = {
    place: currentLang === 'fr' ? 'lieu' : currentLang === 'es' ? 'lugar' : 'place',
    story: currentLang === 'fr' ? 'histoire' : currentLang === 'es' ? 'historia' : 'story',
    moment: currentLang === 'fr' ? 'moment' : currentLang === 'es' ? 'momento' : 'moment'
  };
  
  const locationMap = {
    sitges: currentLang === 'fr' ? 'Sitges/environs' : currentLang === 'es' ? 'Sitges/alrededores' : 'Sitges area',
    barcelona: 'Barcelona',
    catalonia: currentLang === 'fr' ? 'Catalogne' : currentLang === 'es' ? 'Catalu√±a' : 'Catalonia',
    other: currentLang === 'fr' ? 'hors Catalogne' : currentLang === 'es' ? 'fuera de Catalu√±a' : 'outside Catalonia'
  };
  
  const timingMap = {
    fixed: currentLang === 'fr' ? 'date fix√©e' : currentLang === 'es' ? 'fecha fija' : 'fixed date',
    approx: currentLang === 'fr' ? 'p√©riode approximative' : currentLang === 'es' ? 'per√≠odo aproximado' : 'approximate period',
    flexible: currentLang === 'fr' ? 'flexible' : currentLang === 'es' ? 'flexible' : 'flexible'
  };
  
  const promptLanguage = currentLang === 'fr' ? 'fran√ßais' : currentLang === 'es' ? 'espa√±ol' : 'English';
  
  const prompt = `Tu es Marina, photographe professionnelle bas√©e √† Sitges (Barcelone).

Un client vient de compl√©ter mon questionnaire. Voici ses r√©ponses :

PROJET
Client : ${state.name || 'Non renseign√©'}
Projet : ${state.project || 'Non renseign√©'}
Type : ${coreMap[state.core] || 'non sp√©cifi√©'}
Intentions : ${state.intent.join(', ') || 'non sp√©cifi√©'}

USAGE
Temporalit√© : ${state.time || 'non sp√©cifi√©'}
Canaux : ${state.where.join(', ') || 'non sp√©cifi√©'}

LOGISTIQUE
Lieu : ${locationMap[state.location] || 'non sp√©cifi√©'}
Timing : ${timingMap[state.timing] || 'non sp√©cifi√©'}

AMBIANCE (√©chelle 0-100)
√ânergie : ${state.sliders.calm} (0=tr√®s calme, 100=tr√®s dynamique)
Proximit√© : ${state.sliders.present} (0=loin/contextuel, 100=proche/intime)
Richesse : ${state.sliders.rich} (0=√©pur√©, 100=textur√©)

Cr√©e un brief photographique concis en ${promptLanguage} (200-250 mots max).

TON ET APPROCHE :
- Parle comme une photographe pro, pas comme un consultant
- Premi√®re personne (je)
- Direct, sobre, pas de fluff
- Pas de promesses d√©taill√©es
- Reste factuel

STRUCTURE :
1. Une phrase de synth√®se (ce que je comprends)
2. Mon approche (3-4 phrases bas√©es sur les ambiances)
3. Points logistiques (lieu + timing mentionn√©s simplement)
4. Prochaine √©tape (1 phrase courte)

INTERDICTIONS STRICTES :
- NE PAS inventer de d√©tails
- NE PAS proposer de nombres d'images
- NE PAS faire de shot list
- NE PAS donner de prix
- NE PAS √™tre trop enthousiaste ou vendeur
- Rester professionnel et sobre

Format : texte simple, pas de markdown, sauts de ligne entre paragraphes.`;

  const response = await fetch('https://api.anthropic.com/v1/messages', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'anthropic-version': '2023-06-01'
    },
    body: JSON.stringify({
      model: 'claude-sonnet-4-20250514',
      max_tokens: 800,
      messages: [{
        role: 'user',
        content: prompt
      }]
    })
  });

  if (!response.ok) {
    throw new Error('API request failed');
  }

  const data = await response.json();
  return data.content[0].text;
}

function generateFallbackReport() {
  // Fallback si l'AI ne marche pas
  const projectName = state.project || (currentLang === 'fr' ? 'Votre projet' : currentLang === 'es' ? 'Su proyecto' : 'Your project');
  
  let report = `${projectName}\n\n`;
  
  if (currentLang === 'fr') {
    report += `Ce que je comprends\n\nVous cherchez √† photographier ${state.core === 'place' ? 'un lieu' : state.core === 'story' ? 'une histoire' : 'un moment'}. `;
    report += `Les images vont vivre sur ${state.where.join(' et ')}. `;
    report += `L'important pour vous : ${state.intent.length > 0 ? state.intent.join(', ') : 'cr√©er des images authentiques'}.\n\n`;
    
    report += `Direction photographique\n\n`;
    report += `√ânergie ${state.sliders.calm < 40 ? 'calme et contemplative' : state.sliders.calm > 60 ? 'vivante et dynamique' : '√©quilibr√©e'}. `;
    report += `Proximit√© ${state.sliders.present < 40 ? 'discr√®te avec vue d\'ensemble' : state.sliders.present > 60 ? 'intime avec focus sur les d√©tails' : 'modul√©e'}. `;
    report += `Esth√©tique ${state.sliders.rich < 40 ? '√©pur√©e et minimaliste' : state.sliders.rich > 60 ? 'riche en textures' : '√©quilibr√©e'}.\n\n`;
    
    if (state.avoid) {
      report += `Points d'attention\n\n√Ä √©viter : ${state.avoid}\n\n`;
    }
    
    report += `Prochaine √©tape\n\nOn en discute pour affiner les d√©tails et je vous pr√©pare une proposition adapt√©e.`;
  } else if (currentLang === 'es') {
    report += `Lo que entiendo\n\nBusca fotografiar ${state.core === 'place' ? 'un lugar' : state.core === 'story' ? 'una historia' : 'un momento'}. `;
    report += `Las im√°genes vivir√°n en ${state.where.join(' y ')}. `;
    report += `Lo importante para usted: ${state.intent.length > 0 ? state.intent.join(', ') : 'crear im√°genes aut√©nticas'}.\n\n`;
    
    report += `Direcci√≥n fotogr√°fica\n\n`;
    report += `Energ√≠a ${state.sliders.calm < 40 ? 'tranquila y contemplativa' : state.sliders.calm > 60 ? 'viva y din√°mica' : 'equilibrada'}. `;
    report += `Proximidad ${state.sliders.present < 40 ? 'discreta con visi√≥n general' : state.sliders.present > 60 ? '√≠ntima con foco en detalles' : 'modulada'}. `;
    report += `Est√©tica ${state.sliders.rich < 40 ? 'depurada y minimalista' : state.sliders.rich > 60 ? 'rica en texturas' : 'equilibrada'}.\n\n`;
    
    if (state.avoid) {
      report += `Puntos de atenci√≥n\n\nEvitar: ${state.avoid}\n\n`;
    }
    
    report += `Pr√≥ximo paso\n\nLo discutimos para afinar los detalles y le preparo una propuesta adaptada.`;
  } else {
    report += `What I understand\n\nYou're looking to photograph ${state.core === 'place' ? 'a place' : state.core === 'story' ? 'a story' : 'a moment'}. `;
    report += `Images will live on ${state.where.join(' and ')}. `;
    report += `What matters to you: ${state.intent.length > 0 ? state.intent.join(', ') : 'creating authentic images'}.\n\n`;
    
    report += `Photographic direction\n\n`;
    report += `Energy ${state.sliders.calm < 40 ? 'calm and contemplative' : state.sliders.calm > 60 ? 'lively and dynamic' : 'balanced'}. `;
    report += `Proximity ${state.sliders.present < 40 ? 'discreet with overview' : state.sliders.present > 60 ? 'intimate with detail focus' : 'modulated'}. `;
    report += `Aesthetic ${state.sliders.rich < 40 ? 'clean and minimalist' : state.sliders.rich > 60 ? 'rich in textures' : 'balanced'}.\n\n`;
    
    if (state.avoid) {
      report += `Attention points\n\nAvoid: ${state.avoid}\n\n`;
    }
    
    report += `Next step\n\nLet's discuss to refine details and I'll prepare an adapted proposal.`;
  }
  
  return report;
}

function displayReport(reportText) {
  const content = document.getElementById('content');
  
  // Format the report text into HTML sections
  const sections = reportText.split('\n\n').filter(s => s.trim());
  const formattedSections = sections.map((section, index) => {
    const lines = section.split('\n');
    const title = lines[0];
    const body = lines.slice(1).join('\n');
    
    if (index === sections.length - 1) {
      // Last section gets special styling
      return `
        <div class="report-section report-closing">
          <h3>${title}</h3>
          ${body ? `<p>${body.replace(/\n/g, '<br>')}</p>` : ''}
        </div>
      `;
    } else {
      return `
        <div class="report-section">
          <h3>${title}</h3>
          ${body ? `<p>${body.replace(/\n/g, '<br>')}</p>` : ''}
        </div>
      `;
    }
  }).join('');
  
  const radarHTML = generateRadarChart();
  
  content.innerHTML = `
    <div class="kicker">${t('report.kicker')}</div>
    <h1>${state.project || t('report.title')}</h1>
    ${state.name ? `<p class="lead">${currentLang === 'fr' ? 'Bonjour' : currentLang === 'es' ? 'Hola' : 'Hello'} ${state.name}</p>` : ''}
    
    ${radarHTML}
    
    ${formattedSections}
    
    <div class="buttons">
      <button class="primary" onclick="downloadPDF()">${t('report.buttons.pdf')}</button>
      <button class="secondary" onclick="sendEmail()">${t('report.buttons.email')}</button>
      <button class="secondary" onclick="restart()">${t('report.buttons.restart')}</button>
    </div>
  `;
}

function generateRadarChart() {
  const width = 320;
  const height = 280;
  const cx = width / 2;
  const cy = height / 2;
  const radius = 90;
  
  const angles = [-90, 30, 150]; // calm, present, rich
  const values = [state.sliders.calm, state.sliders.present, state.sliders.rich];
  
  const labels = currentLang === 'fr' 
    ? ['√ânergie', 'Proximit√©', 'Richesse']
    : currentLang === 'es'
    ? ['Energ√≠a', 'Cercan√≠a', 'Riqueza']
    : ['Energy', 'Closeness', 'Richness'];
  
  function polarToCart(angle, r) {
    const rad = (angle * Math.PI) / 180;
    return {
      x: cx + r * Math.cos(rad),
      y: cy + r * Math.sin(rad)
    };
  }
  
  // Grid circles
  let gridPath = '';
  [0.33, 0.66, 1].forEach(ratio => {
    const r = radius * ratio;
    const points = angles.map(a => polarToCart(a, r));
    gridPath += `<polygon points="${points.map(p => `${p.x},${p.y}`).join(' ')}" 
      fill="none" stroke="#E5D5BC" stroke-width="1"/>`;
  });
  
  // Data polygon
  const dataPoints = values.map((val, i) => {
    const r = (val / 100) * radius;
    return polarToCart(angles[i], r);
  });
  
  const dataPath = `<polygon points="${dataPoints.map(p => `${p.x},${p.y}`).join(' ')}" 
    fill="rgba(200, 168, 130, 0.2)" stroke="#C8A882" stroke-width="2"/>`;
  
  // Labels
  const labelSVG = labels.map((label, i) => {
    const labelPos = polarToCart(angles[i], radius + 25);
    let anchor = 'middle';
    if (angles[i] > 0 && angles[i] < 180) anchor = 'start';
    if (angles[i] > 180) anchor = 'end';
    
    return `<text x="${labelPos.x}" y="${labelPos.y}" 
      fill="#2C2C2C" font-size="14" font-weight="600" text-anchor="${anchor}">${label}</text>`;
  }).join('');
  
  return `
    <div class="radar-container">
      <svg id="radarChart" width="${width}" height="${height}" viewBox="0 0 ${width} ${height}">
        ${gridPath}
        ${dataPath}
        ${labelSVG}
      </svg>
    </div>
  `;
}

function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  
  // Colors
  const gold = [200, 168, 130];
  const goldLight = [229, 213, 188];
  const dark = [44, 44, 44];
  const cream = [245, 241, 232];
  
  // Fonts
  doc.setFont('helvetica', 'normal');
  
  let y = 20;
  
  // Header with logo
  doc.setFillColor(...goldLight);
  doc.rect(0, 0, 210, 35, 'F');
  
  doc.setTextColor(...dark);
  doc.setFontSize(24);
  doc.setFont('helvetica', 'bold');
  doc.text('MARINAPHOTO', 20, 20);
  
  doc.setFontSize(12);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(gold[0], gold[1], gold[2]);
  doc.text('Photography Brief', 20, 27);
  
  y = 50;
  
  // Project title
  doc.setFontSize(20);
  doc.setFont('helvetica', 'bold');
  doc.setTextColor(...dark);
  const projectName = state.project || 'Your Project';
  doc.text(projectName, 20, y);
  y += 10;
  
  if (state.name) {
    doc.setFontSize(12);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(gold[0], gold[1], gold[2]);
    doc.text(state.name, 20, y);
    y += 5;
  }
  
  const date = new Date().toLocaleDateString(currentLang === 'fr' ? 'fr-FR' : currentLang === 'es' ? 'es-ES' : 'en-US', 
    { year: 'numeric', month: 'long', day: 'numeric' });
  doc.setFontSize(10);
  doc.setTextColor(100, 100, 100);
  doc.text(date, 20, y);
  y += 15;
  
  // Visual summary - boxes
  doc.setFillColor(...cream);
  doc.roundedRect(20, y, 170, 45, 3, 3, 'F');
  
  doc.setFontSize(10);
  doc.setFont('helvetica', 'bold');
  doc.setTextColor(...gold);
  
  let boxY = y + 8;
  
  // Type
  const coreMap = {
    place: { fr: 'üè† Lieu', en: 'üè† Place', es: 'üè† Lugar' },
    story: { fr: 'üìñ Histoire', en: 'üìñ Story', es: 'üìñ Historia' },
    moment: { fr: '‚è≥ Moment', en: '‚è≥ Moment', es: '‚è≥ Momento' }
  };
  if (state.core) {
    doc.text('TYPE', 25, boxY);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(...dark);
    doc.text(coreMap[state.core][currentLang] || state.core, 25, boxY + 5);
  }
  
  // Usage
  boxY += 13;
  doc.setFont('helvetica', 'bold');
  doc.setTextColor(...gold);
  doc.text('USAGE', 25, boxY);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(...dark);
  const usageMap = {
    moment: { fr: 'Moment pr√©cis', en: 'Specific moment', es: 'Momento preciso' },
    overtime: { fr: 'Base r√©utilisable', en: 'Reusable base', es: 'Base reutilizable' },
    grow: { fr: 'Continuit√©', en: 'Continuity', es: 'Continuidad' }
  };
  doc.text(state.time ? usageMap[state.time][currentLang] : '‚Äî', 25, boxY + 5);
  
  // Channels
  boxY += 13;
  doc.setFont('helvetica', 'bold');
  doc.setTextColor(...gold);
  doc.text('CANAUX', 25, boxY);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(...dark);
  const channelMap = {
    website: { fr: 'Web', en: 'Website', es: 'Web' },
    social: { fr: 'R√©seaux', en: 'Social', es: 'Redes' },
    editorial: { fr: '√âditorial', en: 'Editorial', es: 'Editorial' },
    print: { fr: 'Print', en: 'Print', es: 'Print' }
  };
  const channels = state.where.map(w => channelMap[w][currentLang]).join(', ');
  doc.text(channels || '‚Äî', 25, boxY + 5);
  
  // Intent - right column
  boxY = y + 8;
  if (state.intent.length > 0) {
    doc.setFont('helvetica', 'bold');
    doc.setTextColor(...gold);
    doc.text('INTENTION', 110, boxY);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(...dark);
    const intentMap = {
      notAI: { fr: 'Authentique', en: 'Authentic', es: 'Aut√©ntico' },
      brand: { fr: 'Coh√©rence marque', en: 'Brand aligned', es: 'Coherencia marca' },
      fresh: { fr: 'Regard neuf', en: 'Fresh perspective', es: 'Mirada nueva' },
      trust: { fr: 'Confiance', en: 'Trust', es: 'Confianza' }
    };
    const intents = state.intent.map(i => intentMap[i][currentLang]).join(', ');
    doc.text(intents, 110, boxY + 5, { maxWidth: 75 });
  }
  
  y += 52;
  
  // Ambiance - visual bars
  doc.setFontSize(12);
  doc.setFont('helvetica', 'bold');
  doc.setTextColor(...dark);
  doc.text(currentLang === 'fr' ? 'AMBIANCE PHOTOGRAPHIQUE' : currentLang === 'es' ? 'AMBIENTE FOTOGR√ÅFICO' : 'PHOTOGRAPHIC VIBE', 20, y);
  y += 8;
  
  const sliderLabels = {
    calm: { 
      fr: ['Calme', 'Vivant'], 
      en: ['Calm', 'Lively'], 
      es: ['Calmo', 'Vivo'] 
    },
    present: { 
      fr: ['Discret', 'Proche'], 
      en: ['Discreet', 'Close'], 
      es: ['Discreto', 'Cercano'] 
    },
    rich: { 
      fr: ['√âpur√©', 'Textur√©'], 
      en: ['Minimal', 'Textured'], 
      es: ['Limpio', 'Texturado'] 
    }
  };
  
  ['calm', 'present', 'rich'].forEach((key, index) => {
    const value = state.sliders[key];
    const labels = sliderLabels[key][currentLang];
    
    doc.setFontSize(9);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(...dark);
    doc.text(labels[0], 20, y);
    doc.text(labels[1], 175, y, { align: 'right' });
    
    y += 3;
    
    // Background bar
    doc.setFillColor(...cream);
    doc.roundedRect(20, y, 155, 4, 2, 2, 'F');
    
    // Value bar
    doc.setFillColor(...gold);
    const barWidth = (value / 100) * 155;
    doc.roundedRect(20, y, barWidth, 4, 2, 2, 'F');
    
    y += 10;
  });
  
  y += 5;
  
  // Report text - get from DOM or generate fallback
  const reportSections = document.querySelectorAll('.report-section:not(.report-closing)');
  
  if (reportSections.length > 0) {
    reportSections.forEach((section, index) => {
      if (y > 250) {
        doc.addPage();
        y = 20;
      }
      
      const title = section.querySelector('h3')?.textContent || '';
      const text = section.querySelector('p')?.textContent || '';
      
      doc.setFontSize(11);
      doc.setFont('helvetica', 'bold');
      doc.setTextColor(...gold);
      doc.text(title.toUpperCase(), 20, y);
      y += 7;
      
      doc.setFontSize(10);
      doc.setFont('helvetica', 'normal');
      doc.setTextColor(...dark);
      const lines = doc.splitTextToSize(text, 170);
      doc.text(lines, 20, y);
      y += (lines.length * 5) + 8;
    });
  }
  
  // Avoid section if present
  if (state.avoid && y < 250) {
    doc.setFillColor(255, 250, 240);
    doc.roundedRect(20, y, 170, 15, 3, 3, 'F');
    
    doc.setFontSize(9);
    doc.setFont('helvetica', 'bold');
    doc.setTextColor(180, 50, 50);
    doc.text(currentLang === 'fr' ? '√Ä √âVITER' : currentLang === 'es' ? 'EVITAR' : 'AVOID', 25, y + 6);
    
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(80, 80, 80);
    doc.text(state.avoid, 25, y + 11, { maxWidth: 160 });
    
    y += 20;
  }
  
  // Footer
  if (y > 250) {
    doc.addPage();
    y = 20;
  }
  
  doc.setFillColor(...goldLight);
  doc.rect(0, 280, 210, 17, 'F');
  
  doc.setFontSize(10);
  doc.setFont('helvetica', 'bold');
  doc.setTextColor(...dark);
  doc.text('MARINAPHOTO', 20, 289);
  
  doc.setFont('helvetica', 'normal');
  doc.setFontSize(9);
  doc.setTextColor(100, 100, 100);
  doc.text('hello@marinaphoto.es', 105, 289, { align: 'center' });
  doc.text('Based in Sitges, working around Barcelona', 190, 289, { align: 'right' });
  
  // Save
  const filename = `marinaphoto-brief-${state.project ? state.project.replace(/[^a-z0-9]/gi, '-').toLowerCase() : 'project'}.pdf`;
  doc.save(filename);
}

function sendEmail() {
  const subject = encodeURIComponent(`Brief projet : ${state.project || 'photo'}`);
  const body = encodeURIComponent(`Bonjour Marina,\n\nJe viens de compl√©ter le brief pour mon projet.\n\nCordialement,\n${state.name || ''}`);
  window.location.href = `mailto:hello@marinaphoto.es?subject=${subject}&body=${body}`;
}

function restart() {
  if (confirm(currentLang === 'fr' ? 'Recommencer le questionnaire ?' : currentLang === 'es' ? '¬øReiniciar el cuestionario?' : 'Restart questionnaire?')) {
    currentStep = 0;
    state = {
      name: '',
      project: '',
      core: null,
      intent: [],
      time: null,
      where: [],
      location: null,
      timing: null,
      sliders: { calm: 50, present: 50, rich: 50 }
    };
    render();
  }
}

// Event handlers
function bindEvents() {
  const options = document.querySelectorAll('.option');
  options.forEach(opt => {
    opt.addEventListener('click', function() {
      const id = this.getAttribute('data-id');
      
      // Handle single vs multi-select based on current step
      if (currentStep === 3 || currentStep === 5 || currentStep === 7 || currentStep === 8) {
        // Single select (core, time, location, timing)
        document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
        this.classList.add('selected');
        if (currentStep === 3) state.core = id;
        if (currentStep === 5) state.time = id;
        if (currentStep === 7) state.location = id;
        if (currentStep === 8) state.timing = id;
      } else if (currentStep === 4 || currentStep === 6) {
        // Multi-select (intent, where)
        const isSelected = this.classList.contains('selected');
        const maxItems = 2;
        
        if (currentStep === 4) {
          if (isSelected) {
            state.intent = state.intent.filter(i => i !== id);
            this.classList.remove('selected');
          } else {
            if (state.intent.length < maxItems) {
              state.intent.push(id);
              this.classList.add('selected');
            } else {
              alert(t('intent.hint'));
            }
          }
        }
        
        if (currentStep === 6) {
          if (isSelected) {
            state.where = state.where.filter(w => w !== id);
            this.classList.remove('selected');
          } else {
            if (state.where.length < maxItems) {
              state.where.push(id);
              this.classList.add('selected');
            } else {
              alert(t('where.hint'));
            }
          }
        }
      }
    });
  });
}

function saveName() {
  state.name = document.getElementById('name-input').value.trim();
  nextStep();
}

function saveProject() {
  state.project = document.getElementById('project-input').value.trim();
  nextStep();
}

function validateCore() {
  if (!state.core) {
    alert(t('pickOne'));
    return;
  }
  nextStep();
}

function validateIntent() {
  if (state.intent.length === 0) {
    alert(t('pickAtLeastOne'));
    return;
  }
  nextStep();
}

function validateTime() {
  if (!state.time) {
    alert(t('pickOne'));
    return;
  }
  nextStep();
}

function validateWhere() {
  if (state.where.length === 0) {
    alert(t('pickAtLeastOne'));
    return;
  }
  nextStep();
}

function validateLocation() {
  if (!state.location) {
    alert(t('pickOne'));
    return;
  }
  nextStep();
}

function validateTiming() {
  if (!state.timing) {
    alert(t('pickOne'));
    return;
  }
  nextStep();
}

function updateSlider(input) {
  const key = input.getAttribute('data-key');
  state.sliders[key] = parseInt(input.value);
}

function saveAvoid() {
  state.avoid = document.getElementById('avoid-input').value.trim();
  nextStep();
}

// Initialize
console.log('App initializing...');
render();
console.log('App ready!');
</script>

</body>
</html>
